<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Monadicons — Create your personal icon</title>
  <meta name="description" content="Create unique, eye-catching SVG/PNG icons for your profiles, websites, and socials. No design skills required." />
  <meta name="theme-color" content="#7C3AED" />
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/jdenticon@3.2.0/dist/jdenticon.min.js"></script>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Monadicons</h1>
        <p class="lead">Create unique, eye-catching icons in seconds — no design skills or installs.</p>
      </div>
    </header>

    <main class="card">
      <section class="left">
        <h3 style="margin:0 0 6px;font-size:15px">Icon Generator</h3>

        <label for="seed">Seed / Name</label>
        <input id="seed" type="text" placeholder="e.g., aurora" value="" autocomplete="off" />

        <label for="style">Style</label>
        <select id="style">
          <option value="adventurer">Adventurer (DiceBear)</option>
          <option value="avataaars">Avataaars (DiceBear)</option>
          <option value="pixel-art-neutral">Pixel (DiceBear)</option>
          <option value="identicon">Identicon (DiceBear)</option>
          <option value="micah">Micah (DiceBear)</option>
          <option value="jdenticon">Jdenticon (local)</option>
        </select>

        <label for="bgType">Background Type</label>
        <select id="bgType">
          <option value="transparent">Transparent</option>
          <option value="solid">Solid</option>
        </select>

        <label for="bgColor">Background Color</label>
        <input id="bgColor" type="color" value="#ffffff" />

        <label for="size">Size (px)</label>
        <input id="size" type="number" value="512" min="64" max="1024" />

        <div class="controls">
          <button id="generate" class="primary">Generate</button>
          <button id="downloadSvg" class="ghost" disabled>Download SVG</button>
          <button id="downloadPng" class="ghost" disabled>Download PNG</button>
          <button id="copyEmbed" class="ghost" disabled>Copy Embed</button>
          <button id="share" class="ghost" disabled>Share</button>
        </div>
      </section>

      <aside class="preview">
        <h4 style="margin:0 0 8px;font-size:14px">Preview</h4>
        <div id="previewBox" class="preview-box">Select options and click Generate</div>
        <div id="previewMeta" class="meta">Style: — • Seed: — • Size: —</div>
      </aside>
    </main>

    <footer>
      Avatars powered by 
      <a href="https://www.dicebear.com" target="_blank">DiceBear</a> and 
      <a href="https://jdenticon.com" target="_blank">Jdenticon</a> — MIT licensed
    </footer>
  </div>

  <script>
    const seedInput = document.getElementById('seed');
    const styleSelect = document.getElementById('style');
    const bgTypeSelect = document.getElementById('bgType');
    const bgColorInput = document.getElementById('bgColor');
    const sizeInput = document.getElementById('size');

    const generateBtn = document.getElementById('generate');
    const downloadSvgBtn = document.getElementById('downloadSvg');
    const downloadPngBtn = document.getElementById('downloadPng');
    const copyEmbedBtn = document.getElementById('copyEmbed');
    const shareBtn = document.getElementById('share');

    const previewBox = document.getElementById('previewBox');
    const previewMeta = document.getElementById('previewMeta');

    let currentSvg = '';
    let currentSeed = '';
    let currentStyle = '';
    let currentSize = 512;

    function enableActions() {
      downloadSvgBtn.disabled = false;
      downloadPngBtn.disabled = false;
      copyEmbedBtn.disabled = false;
      shareBtn.disabled = false;
    }

    generateBtn.addEventListener('click', async () => {
      currentSeed = seedInput.value.trim() || 'anon';
      currentStyle = styleSelect.value;
      currentSize = parseInt(sizeInput.value, 10) || 512;

      let svg = '';
      if (currentStyle === 'jdenticon') {
        svg = jdenticon.toSvg(currentSeed, currentSize);
      } else {
        const url = `https://api.dicebear.com/7.x/${currentStyle}/svg?seed=${encodeURIComponent(currentSeed)}&size=${currentSize}`;
        svg = await fetch(url).then(r => r.text());
      }
      currentSvg = svg;

      // Update preview
      previewBox.innerHTML = svg;
      previewMeta.textContent = `Style: ${currentStyle} • Seed: ${currentSeed} • Size: ${currentSize}px`;
      enableActions();
    });

    downloadSvgBtn.addEventListener('click', () => {
      const blob = new Blob([currentSvg], { type: 'image/svg+xml' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${currentSeed}-${currentStyle}.svg`;
      a.click();
      URL.revokeObjectURL(url);
    });

    downloadPngBtn.addEventListener('click', () => {
      const img = new Image();
      const svgBlob = new Blob([currentSvg], { type: 'image/svg+xml' });
      const url = URL.createObjectURL(svgBlob);
      img.onload = () => {
        const canvas = document.createElement('canvas');
        canvas.width = currentSize;
        canvas.height = currentSize;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, currentSize, currentSize);
        canvas.toBlob((blob) => {
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `${currentSeed}-${currentStyle}.png`;
          a.click();
        });
        URL.revokeObjectURL(url);
      };
      img.src = url;
    });

    copyEmbedBtn.addEventListener('click', () => {
      const code = `<img src="data:image/svg+xml;utf8,${encodeURIComponent(currentSvg)}" width="${currentSize}" height="${currentSize}" alt="avatar"/>`;
      navigator.clipboard.writeText(code);
      alert('Embed code copied!');
    });

    shareBtn.addEventListener('click', () => {
      const params = new URLSearchParams({
        seed: currentSeed,
        style: currentStyle,
        size: currentSize
      });
      const link = `${location.origin}${location.pathname}?${params.toString()}`;
      navigator.clipboard.writeText(link);
      alert('Link copied to clipboard!');
    });

    // Optional: auto-load from URL if shared
    window.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('seed')) {
        seedInput.value = urlParams.get('seed');
        styleSelect.value = urlParams.get('style') || 'adventurer';
        sizeInput.value = urlParams.get('size') || '512';
        generateBtn.click();
      }
    });
  </script>
</body>
</html>
